config defaults 'common'
	option syn_flood	1
	option input		ACCEPT
	option output		ACCEPT
	option forward		REJECT
# Uncomment this line to disable ipv6 rules
	option disable_ipv6	1

config zone 'TRUSTED'
	option name			TRUSTED
	list network		'lan4053'
	list network		'lan'
	list network		'vpn'
	option input		ACCEPT
	option output		ACCEPT
	option forward		ACCEPT

config zone 'UNTRUSTED'
    option name			UNTRUSTED
    list network		'wan'
    list network		'wan1'
    list network		'wan2'
	option input		REJECT
	option output		ACCEPT
	option forward		REJECT
	option masq			1
	option mtu_fix		1

config zone 'DMZ'
	option name			DMZ
	#list network		'lan4053'
	option input		ACCEPT
	option output		ACCEPT
	option forward		REJECT

config zone 'GUEST'
	option name			GUEST
	#list network		'lan4053'
	option input		REJECT
	option output		ACCEPT
	option forward		REJECT

config forwarding 'TRUSTED_to_UNTRUSTED'
	option src		TRUSTED
	option dest		UNTRUSTED
config forwarding 'TRUSTED_to_DMZ'
	option src		TRUSTED
	option dest		DMZ
config forwarding 'TRUSTED_to_GUEST'
	option src		TRUSTED
	option dest		GUEST
config forwarding 'GUEST_to_UNTRUSTED'
	option src		GUEST
	option dest		UNTRUSTED

# We need to accept udp packets on port 68,
# see https://dev.openwrt.org/ticket/4108
config rule 'Allow_DHCP_Renew'
	option name			Allow_DHCP_Renew
	option src			UNTRUSTED
	option proto		udp
	option dest_port	68
	option target		ACCEPT
	option family		ipv4

# Allow IPv4 ping
config rule 'Allow_Ping'
	option name			Allow_Ping
	option src			UNTRUSTED
	option proto		icmp
	option icmp_type	echo-request
	option family		ipv4
	option target		ACCEPT

config rule 'Allow_esp'
	option name			Allow_esp
	option src			UNTRUSTED
	option proto		esp
	option target		ACCEPT

config rule 'Allow_ah'
	option name			Allow_ah
	option src			UNTRUSTED
	option proto		ah
	option target		ACCEPT

config rule 'allow_ike_p1'
	option name			allow_ike_p1
	option src			UNTRUSTED
	option proto		udp
	option src_port		500
	option dest_port	500
	option target		ACCEPT

config rule 'allow_ike_p2'
	option name			allow_ike_p2
	option src			UNTRUSTED
	option proto		udp
	option src_port		4500
	option dest_port	4500
	option target		ACCEPT

# include a file with users custom iptables rules
config include USER
	option path /etc/firewall.user


### EXAMPLE CONFIG SECTIONS


# port redirect of remapped ssh port (22001) on UNTRUSTED
config redirect 'SSH_to_GW'
    option name     'SSH_to_GW'
	option src		UNTRUSTED
	option src_dport	22001
    option dest     TRUSTED
	option dest_port	22
	option proto		tcp
    option target       'DNAT'
